{% extends 'base.html' %}

{% block title %}
    {% if name %}
        {{ name }}'s Final Report
    {% else %}
        Pet's Final Report
    {% endif %}
{% endblock %}

{% block content %}

<div class="container-lg">
    {% if pet_data[0].name %}
        <h1><b>{{ pet_data[0].name }}'s Final Report</b></h1>
    {% else %}
        <h1><b>Pet's Final Report</b></h1>
    {% endif %}
    <div class="row">
        {{ pet_data[0].name }} is a   
               
        {% if pet_data[0].age_in_months != 0 and pet_data[0].age_in_years > 1 %}
            {{ pet_data[0].age_in_years }} years and {{ pet_data[0].age_in_months }} months old
        {% elif pet_data[0].age_in_months != 0 and pet_data[0].age_in_years == 1 %}
            {{ pet_data[0].age_in_years }} year and {{ pet_data[0].age_in_months }} months old
        {% elif pet_data[0].age_in_months == 0 and pet_data[0].age_in_years == 1 %}
            {{ pet_data[0].age_in_years }} year and {{ pet_data[0].age_in_months }} month old
        {% else %}
            {{ pet_data[0].age_in_years }} year old
        {% endif %}

        {% if pet_data[0].sex == "female_spayed" %}
            spayed female
        {% elif pet_data[0].sex == "female" %}
            intact female
        {% elif pet_data[0].sex == "male_neutered" %}
            neutered male
        {% elif pet_data[0].sex == "male" %}
            intact male
        {% endif %}

        {{ pet_data[0].breed }} ({{ pet_data[0].species }}). 
        {% if pet_data[0].sex == "female" %}
            <!-- If pet is an intact female -->
            {{ pet_data[0].name }} is 
            {% if pet_data[0].is_pregnant == "y" %}
                <!-- And is pregnant -->
                {% if pet_data[0].species == "Canine" %}
                    <!-- If pet is pregnant, female, and canine, inform user of gestation length -->
                    currently pregnant and is in her 
                    {% if pet_data[0].weeks_gestating > 0 and pet_data[0].weeks_gestating != None %}
                    <!-- Accounts for the first week of gestation --> 
                    {% if pet_data[0].weeks_gestating == 1 %}   
                        {{ pet_data[0].weeks_gestating }}st week of pregnancy (within the first 42 days).
                    <!-- Accounts for the second week of gestation --> 
                    {% elif pet_data[0].weeks_gestating == 2 %}   
                        {{ pet_data[0].weeks_gestating }}nd week of pregnancy (within the first 42 days).
                    <!-- Accounts for the third week of gestation --> 
                    {% elif pet_data[0].weeks_gestating == 3 %}   
                        {{ pet_data[0].weeks_gestating }}rd week of pregnancy (within the first 42 days).
                    <!-- Accounts for the 4th-6th week of gestation --> 
                    {% elif pet_data[0].weeks_gestating >= 3 and pet_data[0].weeks_gestating < 6 %}   
                        {{ pet_data[0].weeks_gestating }}th week of pregnancy (within the first 42 days).
                    {% elif pet_data[0].weeks_gestating >= 6%}   
                        {{ pet_data[0].weeks_gestating }}th week of pregnancy (within the last 21 days).
                    {% endif %}
                {% endif %}
            {% endif %}
            {% elif pet_data[0].is_pregnant == "n" %}
                is not currently pregnant
            {% endif %}
            {% if pet_data[0].is_nursing == "y" %}
                but is actively nursing a litter
                {% if pet_data[0].litter_size != None %}
                    {{ pet_data[0].litter_size }}
                    {% if pet_data[0].species == "Canine" %}
                        puppies.
                    {% elif pet_data[0].species == "Feline" %}
                        kittens.
                    {% endif %}
                {% endif %}
            {% elif pet_data[0].is_nursing == "n" %}
                and is not currently nursing a litter.
            {% endif %}
        {% endif %}
        {{ pet_data[0].name }}'s Resting Energy Rate (RER) was calculated to be 
        {{ rer }} kcal. As a reminder, this is the minimum amount 
        {{ pet_data[0].name }} needs at rest (i.e. if {{ subject_pronoun }} is 
        hospitalized and requires crate rest or if {{ subject_pronoun }} lays 
        around the house at all times). Based on {{ pet_data[0].name }}'s current 
        life stage, {{ subject_pronoun }} requires {{ der }} kcal per day. The 
        following formula was used: 

        <div class="formula">
            DER = {{ pet_data[0].name }}'s RER x DER Modifier
            <br>
            DER = {{ rer }} x {{ pet_data[0].der_modifier }} ({{ life_stage }}, {{ notes }})
        </div>

        Based on {{ pet_data[0].name }}'s current diet, {{ subject_pronoun }} should
        be getting around {{ pet_data[0].current_food_amt_rec }}

    </div>
    
    <table class="table table-sm">
        <thead>
            <tr>
                <th>
                    <b>
                        Pet Name
                    </b>
                </th>
                <th>
                    <b>
                        Age
                    </b>
                </th>
                <th>
                    <b>
                        Species
                    </b>
                </th>
                <th>
                    <b>
                        Breed
                    </b>
                </th>
                <th>
                    <b>
                        Sex
                    </b>
                </th>
                <th>
                    <b>
                        Body Condition Score
                    </b>
                </th>
                <th>
                    <b>
                        Weight
                    </b>
                </th>
                {% if pet_data[0].activity_level != None %}
                    <th>
                        <b>
                            Activity Level
                        </b>
                    </th>
                {% endif %}  
                {% if pet_data[0].is_pregnant != None %}
                    <th>
                        <b>
                            Is {{ pet_data[0].name}} Pregnant?
                        </b>
                    </th>
                {% endif %}  
                {% if pet_data[0].weeks_gestating != None and pet_data[0].weeks_gestating != 0 %}
                    <th>
                        <b>
                            {{ pet_data[0].name}}'s Gestation Length
                        </b>
                    </th>
                {% endif %}  
                {% if pet_data[0].is_nursing == "y" %}
                    <th>
                        <b>
                            Pet is Nursing?
                        </b>
                    </th>
                {% endif %}  
                {% if pet_data[0].litter_size != None %}
                    <th>
                        <b>
                            Current Litter Size
                        </b>
                    </th>
                {% endif %}  
                {% if pet_data[0].weeks_nursing != None %}
                    <th>
                        <b>
                            Weeks Nursing
                        </b>
                    </th>
                {% endif %}    
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    {{ pet_data[0].name }}
                    
                    <a href="{{ url_for('pet_info') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                <td>
                    {{ pet_data[0].age_in_years }} years {{ pet_data[0].age_in_months }} months old
                    
                    <a href="{{ url_for('pet_info_continued') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                <td>
                    {{ pet_data[0].species }}

                    <a href="{{ url_for('pet_info') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                <td>
                    {{ pet_data[0].breed }}

                    <a href="{{ url_for('pet_info_continued') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                <td>
                    {% if pet_data[0].sex == "female_spayed" %}
                        Female (Spayed)
                    {% elif pet_data[0].sex == "female" %}
                        Female (Intact)
                    {% elif pet_data[0].sex == "male_neutered" %}
                        Male (Neutered)
                    {% elif pet_data[0].sex == "male" %}
                        Male (Intact)
                    {% endif %}

                    <a href="{{ url_for('pet_info_continued') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                <td>
                    {{ pet_data[0].bcs }}/9

                    <a href="{{ url_for('pet_condition') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                <td>
                    {{ pet_data[0].weight }} {{ pet_data[0].units }} 

                    <a href="{{ url_for('pet_condition') }}">
                        <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                    </a>
                </td>
                {% if pet_data[0].activity_level != None %}
                    <td>
                        {{ pet_data[0].activity_level }}

                        <a href="{{ url_for('activity') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% endif %}
                {% if pet_data[0].is_pregnant == "y" %}
                    <td>
                        Yes

                        <a href="{{ url_for('repro_status') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% elif pet_data[0].is_pregnant == "n" %}
                    <td>
                        No

                        <a href="{{ url_for('repro_status') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% endif %}  
                {% if pet_data[0].weeks_gestating != None and pet_data[0].weeks_gestating != 0 %}
                    <td>
                        {{ pet_data[0].weeks_gestating }} weeks

                        <a href="{{ url_for('gestation_duration') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% endif %}  
                {% if pet_data[0].is_nursing != None and pet_data[0].is_nursing == "y" %}
                    <td>
                        Yes

                        <a href="{{ url_for('lactation_status') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% elif pet_data[0].is_nursing != None and pet_data[0].is_nursing == "n" %}
                    <td>
                        No

                        <a href="{{ url_for('lactation_status') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% endif %}
                {% if pet_data[0].litter_size != None %}
                    <td>
                        {{ pet_data[0].litter_size }}
                        {% if pet_data[0].species == "Canine" %}
                            puppies
                        {% elif pet_data[0].species == "Feline" %}
                            kittens
                        {% endif %}
                        <a href="{{ url_for('litter_size') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% endif %}  
                {% if pet_data[0].weeks_nursing != None %}
                    <td>
                        {{ pet_data[0].weeks_nursing }}

                        <a href="{{ url_for('lactation_duration') }}">
                            <button type="button" class="btn btn-secondary btn-sm">Edit</button>
                        </a>
                    </td>
                {% endif %}    
            </tr>
        </tbody>
    </table>

    <!-- Go back --> 
    <div class="button-container">
         <a href="{{ url_for('der') }}">
            <button type="button" class="btn btn-secondary btn-lg">Go to Part 6: Pet's DER</button>
        </a>

        <!-- Divider solution suggested by Michael Allen on Stack Overflow -->
        <div class="divider"></div>
        
        <!-- TODO: Make a "Print Report" button --> 
    </div>
</div>

{% endblock %}